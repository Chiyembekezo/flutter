FROM google/dart

RUN apt update && apt-get -y install unzip zip clang cmake ninja-build pkg-config libgtk-3-dev xvfb

RUN git clone https://github.com/flutter/flutter.git
ENV PATH "$PATH:/flutter/bin"
RUN flutter channel dev
RUN flutter upgrade
RUN flutter config --enable-linux-desktop
ADD packages /app/packages
WORKDIR /app/packages/peon
RUN flutter pub get
ENTRYPOINT ["sh", "run.sh"]